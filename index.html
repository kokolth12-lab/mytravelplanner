<!DOCTYPE html>
<html lang="zh-TW">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <script src="https://cdn.tailwindcss.com"></script>
Â  Â  <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;700;800;900&family=Noto+Sans+TC:wght@400;700;900&display=swap" rel="stylesheet">
Â  Â  <title>é—œè¥¿å†¬æ—¥å¤¢å¹»æ‰‹æœ­ | 2026 å†’éšªèªŒ</title>
Â  Â  <style>
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --bg-main: #F4FBFF;
Â  Â  Â  Â  Â  Â  --magic-blue: #0ea5e9;
Â  Â  Â  Â  Â  Â  --magic-pink: #ec4899;
Â  Â  Â  Â  Â  Â  --magic-purple: #8b5cf6;
Â  Â  Â  Â  Â  Â  --magic-teal: #14b8a6;
Â  Â  Â  Â  Â  Â  --magic-yellow: #f59e0b;
Â  Â  Â  Â  Â  Â  --dark-border: #1e293b;
Â  Â  Â  Â  Â  Â  --pass-theme: #6366f1;
Â  Â  Â  Â  }

Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: 'Lexend', 'Noto Sans TC', sans-seriæ—¥
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #e0f2fe 0%, æ—¥f5f9 50%, #fce7f3 100%);
Â  Â  Â  Â  Â  Â  min-height: 100vh;
Â  Â  Â  Â  Â  Â  color: #1e293b;
Â  Â  Â  Â  Â  Â  overflow-x: hidden;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- 3D è³ªæ„Ÿé€šç”¨æ¨£å¼ (çµ±ä¸€åœ“å½¢åº•æ¡†) --- */
Â  Â  Â  Â  .btn-style {
Â  Â  Â  Â  Â  Â  border: 2px solid var(--dark-border);
Â  Â  Â  Â  Â  Â  border-bottom-width: 5px;
Â  Â  Â  Â  Â  Â  transition: all 0.1s ease;
Â  Â  Â  Â  Â  Â  border-radius: 50px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn-style:active {
Â  Â  Â  Â  Â  Â  transform: translateY(2px);
Â  Â  Â  Â  Â  Â  border-bottom-width: 2px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .card-shape { border-radius: 24px; }

Â  Â  Â  Â  /* --- è¼‰å…¥å‹•ç•« --- */
Â  Â  Â  Â  #loading-screen {
Â  Â  Â  Â  Â  Â  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
Â  Â  Â  Â  Â  Â  background: #fff; display: flex; flex-direction: column; justify-content: center; align-items: center;
Â  Â  Â  Â  Â  Â  z-index: 9999; opacity: 1; visibility: visible;
Â  Â  Â  Â  Â  Â  transition: opacity 1s ease-out, visibility 1s ease-out;
Â  Â  Â  Â  }
Â  Â  Â  Â  .loading-plane { font-size: 3rem; color: #3f51b5; animation: flyAcross 2s ease-in-out forwards; }
Â  Â  Â  Â  @keyframes flyAcross {
Â  Â  Â  Â  Â  Â  0% { transform: translateX(-110vw) translateY(20px) rotate(10deg); opacity: 0; }
Â  Â  Â  Â  Â  Â  50% { opacity: 1; }
Â  Â  Â  Â  Â  Â  100% { transform: translateX(110vw) translateY(-20px) rotate(10deg); opacity: 0; }
Â  Â  Â  Â  }

Â  Â  Â  Â  #main-app-container {
Â  Â  Â  Â  Â  Â  opacity: 0; visibility: hidden; transition: opacity 0.8s ease-in;
Â  Â  Â  Â  Â  Â  max-width: 1000px; margin: 0 auto; padding: 0 15px;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- é¦–é æ¡†æ¶ --- */
Â  Â  Â  Â  .app-grid { display: grid; grid-template-columns: 1fr; gap: 15px; align-items: start; padding-top: 10px; }
Â  Â  Â  Â  @media (min-width: 1024px) { .app-grid { grid-template-columns: 320px 1fr; gap: 25px; } }

Â  Â  Â  Â  .card { background: white; border: 2px solid var(--dark-border); border-bottom-width: 6px; border-radius: 24px; box-shadow: 0 10px 30px rgba(0,0,0,0.03); }
Â  Â  Â  Â  .card-main { position: sticky; top: 15px; padding: 20px; border-top: 8px solid var(--pass-theme); overflow: hidden; background: linear-gradient(to bottom right, #ffffff, #f5f7ff); }
Â  Â  Â  Â  .pass-tag { background: #eef2ff; color: #4338ca; padding: 3px 12px; border-radius: 50px; font-size: 0.6rem; font-weight: 900; letter-spacing: 0.5px; margin-bottom: 12px; display: inline-block; text-transform: uppercase; border: 2px solid var(--dark-border); }
Â  Â  Â  Â 
Â  Â  Â  Â  .info-item { background: #f8fafc; padding: 10px 14px; border-radius: 15px; margin-bottom: 8px; cursor: pointer; border: 2px solid var(--dark-border); border-bottom-width: 4px; transition: 0.2s; }
Â  Â  Â  Â  .info-item:hover { background: #fff; transform: translateY(-1px); }
Â  Â  Â  Â  .label { font-size: 0.5rem; font-weight: 800; color: #94a3b8; letter-spacing: 1.2px; margin-bottom: 2px; display: block; }
Â  Â  Â  Â  .value { font-size: 0.85rem; font-weight: 900; color: #1e293b; outline: none; }

Â  Â  Â  Â  .teaser-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
Â  Â  Â  Â  .card-teaser {
Â  Â  Â  Â  Â  Â  background: white; border-radius: 26px; padding: 15px 10px;
Â  Â  Â  Â  Â  Â  display: flex; flex-direction: column; align-items: center; justify-content: center;
Â  Â  Â  Â  Â  Â  cursor: pointer; border: 2.5px solid var(--dark-border); border-bottom-width: 6px;
Â  Â  Â  Â  Â  Â  transition: 0.2s; min-height: 105px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .card-teaser:active { transform: translateY(3px); border-bottom-width: 3px; }
Â  Â  Â  Â  .teaser-icon { font-size: 1.8rem; margin-bottom: 5px; }
Â  Â  Â  Â  .teaser-title { font-weight: 900; font-size: 0.75rem; color: #1e293b; text-align: center; }
Â  Â  Â  Â 
Â  Â  Â  Â  .teaser-itinerary { background: linear-gradient(135deg, #fff5f7, #fce4ec); border-top: 3px solid #ec4899; }
Â  Â  Â  Â  .teaser-money { background: linear-gradient(135deg, #f0fdf4, #dcfce7); border-top: 3px solid #14b8a6; }
Â  Â  Â  Â  .teaser-prep { background: linear-gradient(135deg, #fffbeb, #fef3c7); border-top: 3px solid #f59e0b; }
Â  Â  Â  Â  .teaser-shopping { background: linear-gradient(135deg, #f0f9ff, #e0f2fe); border-top: 3px solid #0ea5e9; }
Â  Â  Â  Â  .teaser-mood { background: linear-gradient(135deg, #f5f3ff, #ede9fe); border-top: 3px solid #8b5cf6; }
Â  Â  Â  Â  .teaser-ref { background: linear-gradient(135deg, #f0fdfa, #ccfbf1); border-top: 3px solid #14b8a6; }

Â  Â  Â  Â  /* --- å½ˆå‡ºå±¤ç³»çµ± --- */
Â  Â  Â  Â  .modal-overlay {
Â  Â  Â  Â  Â  Â  display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
Â  Â  Â  Â  Â  Â  background: rgba(15, 23, 42, 0.3); backdrop-filter: blur(12px);
Â  Â  Â  Â  Â  Â  z-index: 3000; justify-content: center; align-items: center;
Â  Â  Â  Â  }
Â  Â  Â  Â  .modal-content-base {
Â  Â  Â  Â  Â  Â  width: 95vw; height: 92vh; background: #fff; border-radius: 40px;
Â  Â  Â  Â  Â  Â  border: 4px solid var(--dark-border); display: flex; flex-direction: column;
Â  Â  Â  Â  Â  Â  overflow: hidden; margin: auto; animation: popIn 0.3s ease-out;
Â  Â  Â  Â  Â  Â  box-shadow: 0 40px 100px rgba(0,0,0,0.2);
Â  Â  Â  Â  }
Â  Â  Â  Â  .modal-header-generic { padding: 18px 30px; border-bottom: 4px solid var(--dark-border); display: flex; justify-content: space-between; align-items: center; flex-shrink: 0; }

Â  Â  Â  Â  /* ğŸ“¸ æ‹ç«‹å¾—é¢¨æ ¼ */
Â  Â  Â  Â  .polaroid-frame {
Â  Â  Â  Â  Â  Â  background: white; padding: 12px 12px 35px 12px; border: 1.5px solid #eee;
Â  Â  Â  Â  Â  Â  box-shadow: 0 10px 25px rgba(0,0,0,0.1); transform: rotate(-1.5deg);
Â  Â  Â  Â  Â  Â  transition: 0.3s ease; width: 100%; max-width: 280px; margin: 0 auto;
Â  Â  Â  Â  }
Â  Â  Â  Â  .polaroid-frame:hover { transform: rotate(0deg) scale(1.05); }
Â  Â  Â  Â  .polaroid-img { width: 100%; height: 180px; object-fit: cover; background: #f1f5f9; border-radius: 2px; cursor: zoom-in; }
Â  Â  Â  Â  .polaroid-caption { font-weight: 900; text-align: center; margin-top: 10px; color: var(--dark-border); font-size: 0.8rem; font-family: cursive, 'Noto Sans TC', sans-serif; }

Â  Â  Â  Â  /* ğŸ—ºï¸ è¡Œç¨‹è¦åŠƒæ¨£å¼ */
Â  Â  Â  Â  .day-tab { padding: 10px 14px; min-width: 80px; flex-shrink: 0; text-align: center; font-size: 0.8rem; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #fff; transition: 0.1s; }
Â  Â  Â  Â  .day-tab.active { background: var(--magic-pink); color: white; transform: translateY(2px); border-bottom-width: 2px; }
Â  Â  Â  Â  .timeline-container { position: relative; max-width: 850px; margin: 0 auto; padding-left: 55px; }
Â  Â  Â  Â  .timeline-container::before { content: ''; position: absolute; left: 18px; top: 0; bottom: 0; width: 5px; background: var(--dark-border); border-radius: 10px; }
Â  Â  Â  Â  .activity-sticker { background: #fff; border: 3px solid var(--dark-border); border-bottom-width: 8px; border-radius: 24px; padding: 20px; margin-bottom: 30px; position: relative; overflow: visible; }
Â  Â  Â  Â  .remove-block-btn { position: absolute; top: 12px; right: 12px; color: #cbd5e1; cursor: pointer; font-size: 1.2rem; }
Â  Â  Â  Â  .type-dropdown-list { position: absolute; top: 110%; left: 0; background: #fff; border: 3px solid var(--dark-border); border-radius: 15px; z-index: 100; display: none; flex-direction: column; width: 140px; padding: 5px; box-shadow: 6px 6px 0px var(--dark-border); }
Â  Â  Â  Â  .type-dropdown-list.show { display: flex; }

Â  Â  Â  Â  /* âœˆï¸ èˆªç­ç¥¨åˆ¸èˆ‡ ğŸ¨ ä½å®¿è©³ç´°æ¨£å¼ */
Â  Â  Â  Â  .pink-vintage-ticket { background: #fffafa; width: 95%; max-width: 800px; border-radius: 15px; display: flex; flex-direction: column; position: relative; border: 3px solid var(--dark-border); border-bottom-width: 8px; font-family: "Courier New", Courier, monospace; }
Â  Â  Â  Â  .ticket-main-title { text-align: center; font-weight: 900; font-size: 1rem; color: var(--dark-border); background: #fce4ec; padding: 10px; border-bottom: 3px solid var(--dark-border); letter-spacing: 2px; }
Â  Â  Â  Â  .ticket-body { display: flex; padding: 25px 0; min-height: 280px; position: relative; width: 100%; }
Â  Â  Â  Â  .ticket-section { flex: 1; padding: 0 35px; display: flex; flex-direction: column; }
Â  Â  Â  Â  .ticket-perforation { width: 4px; position: relative; display: flex; justify-content: center; }
Â  Â  Â  Â  .ticket-perforation .line { border-left: 3px dashed #ec4899; height: 100%; }
Â  Â  Â  Â  .cutout { width: 34px; height: 34px; background: #e0f2fe; border-radius: 50%; position: absolute; left: 50%; transform: translateX(-50%); border: 3px solid var(--dark-border); z-index: 2; }
Â  Â  Â  Â  .cutout.top { top: -17px; } .cutout.bottom { bottom: -17px; }
Â  Â  Â  Â  .pink-tag { display: inline-block; background: var(--magic-pink); color: #fff; padding: 4px 15px; font-size: 0.75rem; margin-bottom: 20px; font-weight: 900; border-radius: 50px; border: 2px solid var(--dark-border); border-bottom-width: 5px; width: fit-content; }
Â  Â  Â  Â  .edit-text { font-size: 1.1rem; font-weight: 900; color: var(--dark-border); border-bottom: 2px dashed #ec4899; outline: none; padding: 2px 0; }

Â  Â  Â  Â  .hotel-entry { display: grid; grid-template-columns: 1fr 1.1fr; gap: 25px; margin-bottom: 40px; padding: 25px; background: #fff; border: 3px solid var(--dark-border); border-bottom-width: 10px; border-radius: 35px; position: relative; }
Â  Â  Â  Â  .hotel-category-box { background: #f8fafc; border: 2px solid var(--dark-border); border-bottom-width: 5px; border-radius: 18px; padding: 14px; margin-bottom: 12px; }
Â  Â  Â  Â  .hotel-cat-label { font-weight: 900; font-size: 0.7rem; color: #fff; padding: 3px 14px; border-radius: 50px; display: inline-block; margin-bottom: 8px; border: 2px solid var(--dark-border); border-bottom-width: 4px; }
Â  Â  Â  Â  .hotel-edit-val { font-size: 0.95rem; font-weight: 800; color: #334155; outline: none; min-height: 22px; line-height: 1.4; }
Â  Â  Â  Â  .big-photo-frame { width: 100%; height: 260px; background: #f1f5f9; border: 4px solid var(--dark-border); border-bottom-width: 10px; border-radius: 20px; overflow: hidden; cursor: pointer; }
Â  Â  Â  Â  .preview-img { width: 100%; height: 100%; object-fit: cover; }
Â  Â  Â  Â  .close-btn-generic { position: absolute; top: 15px; right: 20px; background: #f1f5f9; border: 2.5px solid var(--dark-border); border-bottom-width: 5px; width: 45px; height: 45px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 100; font-weight: bold; }

Â  Â  Â  Â  /* ğŸ’° è¨˜å¸³æœ¬åˆè¨ˆå­—çœ¼æ¨£å¼ */
Â  Â  Â  Â  .tab-sum { font-size: 0.65rem; opacity: 0.7; margin-left: 4px; font-family: monospace; }
Â  Â  Â  Â  .filter-tab { background: #fff; border: 2.5px solid var(--dark-border); border-bottom-width: 5px; border-radius: 50px; padding: 8px 18px; font-weight: 900; font-size: 0.75rem; cursor: pointer; transition: 0.1s; display: flex; align-items: center; }
Â  Â  Â  Â  .filter-tab.active { background: var(--dark-border); color: #fff; transform: translateY(2px); border-bottom-width: 2.5px; }
Â  Â  Â  Â  .sum-grand-badge { background: var(--dark-border); color: #fff; border-radius: 50px; padding: 8px 20px; font-weight: 900; font-size: 0.85rem; border-bottom: 5px solid #000; display: flex; gap: 8px; align-items: center; }

Â  Â  Â  Â  /* ğŸ´ é¤å»³è©•é‘‘æ¨£å¼ */
Â  Â  Â  Â  .rest-card { background: #fdfdfd; border: 3px solid var(--dark-border); border-bottom-width: 8px; border-radius: 25px; padding: 18px; display: flex; flex-direction: column; gap: 8px; position: relative; }
Â  Â  Â  Â  .star-rating { color: #fbbf24; font-size: 1.1rem; }
Â  Â  Â  Â  .rest-img-preview { width: 100%; height: 130px; object-fit: cover; border-radius: 15px; border: 2px solid var(--dark-border); cursor: pointer; margin-bottom: 5px; }

Â  Â  Â  Â  /* ğŸ§® è¨ˆç®—æ©Ÿ */
Â  Â  Â  Â  #floating-calc-btn { position: fixed; bottom: 25px; left: 25px; z-index: 1000; width: 55px; height: 55px; border-radius: 50%; background: #e2e2ff; border: 3px solid var(--dark-border); border-bottom-width: 6px; font-size: 20px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.3s; }
Â  Â  Â  Â  #calc-panel { display: none; position: fixed; bottom: 90px; left: 25px; z-index: 2001; width: 260px; background: white; border: 4px solid var(--dark-border); border-radius: 30px; padding: 18px; flex-direction: column; gap: 10px; box-shadow: 0 25px 60px rgba(0,0,0,0.2); }
Â  Â  Â  Â  .calc-btn { background: #f8fafc; border-radius: 50px; padding: 10px 0; font-weight: 900; transition: 0.1s; border: 2px solid var(--dark-border); border-bottom-width: 5px; }

Â  Â  Â  Â  /* ğŸ“š åƒè€ƒè³‡æ–™å¡ç‰‡ */
Â  Â  Â  Â  .ref-card { background: #fffdf5; border: 3px solid var(--dark-border); border-bottom-width: 8px; border-radius: 25px; padding: 25px; display: flex; flex-direction: column; gap: 10px; position: relative; }

Â  Â  Â  Â  @keyframes popIn { from { opacity: 0; transform: scale(0.93); } to { opacity: 1; transform: scale(1); } }
Â  Â  </style>
</head>
<body oncontextmenu="return false;">

Â  Â  <div id="loading-screen"><div class="loading-plane">âœˆï¸</div><div class="mt-4 font-black text-slate-400 tracking-[0.4em] text-[10px] uppercase">Journey is Loading...</div></div>

Â  Â  <!-- ğŸ§® æ‡¸æµ®è¨ˆç®—æ©Ÿ -->
Â  Â  <div id="floating-calc-btn" onclick="window.toggleCalc()">ğŸ§®</div>
Â  Â  <div id="calc-panel">
Â  Â  Â  Â  <div class="flex justify-between items-center mb-1"><span class="font-black text-[9px] text-gray-400 tracking-widest uppercase">FX: 1 JPY â‰ˆ 0.051 HKD</span><span class="cursor-pointer font-black text-sm" onclick="window.toggleCalc()">âœ•</span></div>
Â  Â  Â  Â  <div class="bg-slate-50 p-4 rounded-3xl border-2 border-slate-100 flex flex-col items-end">
Â  Â  Â  Â  Â  Â  <div class="text-[9px] text-slate-300 font-bold min-h-[1.2em]" id="calc-formula-display"></div>
Â  Â  Â  Â  Â  Â  <div class="text-xl font-black text-slate-800" id="calc-jpy-val">0</div>
Â  Â  Â  Â  Â  Â  <div class="text-xs font-bold text-pink-500">â‰ˆ HK$ <span id="calc-hkd-val">0.00</span></div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="grid grid-cols-4 gap-2 mt-2">
Â  Â  Â  Â  Â  Â  <button class="calc-btn btn-style" onclick="window.appendCalc('7')">7</button><button class="calc-btn btn-style" onclick="window.appendCalc('8')">8</button><button class="calc-btn btn-style" onclick="window.appendCalc('9')">9</button><button class="calc-btn btn-style bg-red-50 text-red-500" onclick="window.clearCalc()">C</button>
Â  Â  Â  Â  Â  Â  <button class="calc-btn btn-style bg-slate-100" onclick="window.appendCalc('4')">4</button><button class="calc-btn btn-style bg-slate-100" onclick="window.appendCalc('5')">5</button><button class="calc-btn btn-style" onclick="window.appendCalc('6')">6</button><button class="calc-btn btn-style bg-slate-100 font-black" onclick="window.setCalcOp('+')">+</button>
Â  Â  Â  Â  Â  Â  <button class="calc-btn btn-style bg-slate-100" onclick="window.appendCalc('1')">1</button><button class="calc-btn btn-style bg-slate-100" onclick="window.appendCalc('2')">2</button><button class="calc-btn btn-style" onclick="window.appendCalc('3')">3</button><button class="calc-btn btn-style bg-slate-100 font-black" onclick="window.setCalcOp('-')">-</button>
Â  Â  Â  Â  Â  Â  <button class="calc-btn btn-style bg-slate-100" onclick="window.appendCalc('0')">0</button><button class="calc-btn btn-style bg-yellow-50" onclick="window.appendCalc('.')">.</button><button class="calc-btn btn-style col-span-2 bg-green-50 text-green-700" onclick="window.solveCalc()">=</button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="main-app-container">
Â  Â  Â  Â  <header class="text-center py-8">
Â  Â  Â  Â  Â  Â  <h1 class="text-3xl font-black text-slate-700 tracking-tighter italic uppercase">âœ¨ Osaka Journey âœ¨</h1>
Â  Â  Â  Â  Â  Â  <p class="text-slate-300 font-bold text-[8px] mt-1 tracking-[0.4em] uppercase">Private Journey Diary 2026</p>
Â  Â  Â  Â  </header>

Â  Â  Â  Â  <div class="app-grid">
Â  Â  Â  Â  Â  Â  <!-- å·¦å´æ‘˜è¦é€šè¡Œè­‰ -->
Â  Â  Â  Â  Â  Â  <aside class="main-column">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card card-main btn-style" style="border-radius: 24px">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="pass-tag">TRAVEL PASS</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2 contenteditable="true" class="text-lg font-black text-slate-800 mb-4 leading-tight" id="main-trip-title">é—œè¥¿å†¬æ—¥å¤¢å¹»æ‰‹æœ­ â„ï¸</h2>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="space-y-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="info-item" onclick="window.openModal('itinerary-modal')">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="label">ğŸ“… ADVENTURE DATES</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="value" contenteditable="true" id="main-trip-date">2026/01/08 - 2026/01/14</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-2 gap-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="info-item" onclick="window.openModal('flight-modal')">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="label">âœˆï¸ FLIGHT</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="value text-[0.65rem]" id="main-flight-summary">BR 198 / 197</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="info-item" onclick="window.openModal('hotel-modal')">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="label">ğŸ¨ HOTELS</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="value text-[0.65rem]" id="main-hotel-summary">å®‰æ’ 0 é–“</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-magic btn-style w-full mt-5 py-3 text-[9px] tracking-widest uppercase" style="background:var(--pass-theme); color:white" onclick="window.saveMainData()">ğŸ’¾ å„²å­˜æ‘˜è¦è³‡æ–™</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </aside>

Â  Â  Â  Â  Â  Â  <!-- å³å´åŠŸèƒ½ç£è²¼çŸ©é™£ -->
Â  Â  Â  Â  Â  Â  <section class="teaser-grid">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-teaser teaser-itinerary btn-style" onclick="window.openModal('itinerary-modal')">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="teaser-icon">ğŸ—“ï¸</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="teaser-title">è¡Œç¨‹è©³ç´°è¦åŠƒ</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-teaser teaser-money btn-style" onclick="window.openModal('money-modal')">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="teaser-icon">ğŸ’°</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="teaser-title">æ—…è²»è¨˜å¸³æœ¬</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-teaser teaser-prep btn-style" onclick="window.openModal('prep-modal')">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="teaser-icon">ğŸ’</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="teaser-title">æ—…è¡Œå‰æº–å‚™</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-teaser teaser-shopping btn-style" onclick="window.openModal('shopping-modal')">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="teaser-icon">ğŸ›ï¸</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="teaser-title">è³¼ç‰©é¡˜æœ›å–®</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-teaser teaser-mood btn-style" onclick="window.openModal('mood-modal')">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="teaser-icon">ğŸ’–</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="teaser-title">æ—…è¡Œå¿ƒæƒ…éš¨ç­†</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="card-teaser teaser-ref btn-style" onclick="window.openModal('reference-modal')">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="teaser-icon">ğŸ“š</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="teaser-title">è¡Œç¨‹åƒè€ƒè³‡æ–™</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </section>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <footer class="text-center py-16 opacity-10 text-[8px] font-black tracking-[0.5em] uppercase">
Â  Â  Â  Â  Â  Â  Curated with Snow & Magic Â© 2026
Â  Â  Â  Â  </footer>
Â  Â  </div>

Â  Â  <!-- å½ˆçª—å…§å®¹å®¹å™¨ç³»çµ± -->
Â  Â  <div id="modal-container" class="modal-overlay">
Â  Â  Â  Â 
Â  Â  Â  Â  <!-- ğŸ’– æ—…è¡Œå¿ƒæƒ…éš¨ç­† (é›™åˆ†é ) -->
Â  Â  Â  Â  <div id="mood-modal" class="hidden modal-content-base">
Â  Â  Â  Â  Â  Â  <div class="modal-header-generic" style="background:var(--magic-purple); color:#fff">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex gap-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="text-lg font-black underline underline-offset-8 decoration-4" id="btn-tab-diary" onclick="window.switchMoodTab('diary')">ğŸ“¸ å¿ƒæƒ…ç´€éŒ„</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="text-lg font-black opacity-50" id="btn-tab-rest" onclick="window.switchMoodTab('restaurant')">ğŸ´ ç¾é£Ÿè©•é‘‘</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-magic btn-style bg-white text-black px-4" onclick="window.closeModal()">âœ•</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  <div id="mood-tab-diary" class="flex-1 overflow-y-auto p-6 space-y-6">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="bg-slate-50 p-6 rounded-[35px] border-2 border-slate-800 space-y-4 shadow-sm">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex flex-wrap gap-3 items-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="date" id="mood-input-date" class="bg-white border-2 border-slate-800 rounded-xl p-2 text-sm font-bold btn-style">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="mood-input-emoji" class="bg-white border-2 border-slate-800 rounded-xl p-2 text-xl outline-none btn-style">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option>âœ¨ é–ƒè€€</option><option>ğŸ˜Š é–‹å¿ƒ</option><option>ğŸ± ç¾é£Ÿ</option><option>â„ï¸ å†¬é›ª</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option>â™¨ï¸ æº«æ³‰</option><option>ğŸ¯ å¤§é˜ªåŸ</option><option>â›©ï¸ ç¥ç¤¾</option><option>ğŸœ æ‹‰éºµ</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option>ğŸš„ æ–°å¹¹ç·š</option><option>ğŸ›ï¸ è³¼ç‰©</option><option>ğŸ¤© æœŸå¾…</option><option>ğŸµ æŠ¹èŒ¶</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-magic btn-style bg-white text-slate-800 border-slate-800 ml-auto" onclick="document.getElementById('mood-file-btn-global').click()">ğŸ“¸ ä¸Šè¼‰ç…§ç‰‡</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="file" id="mood-file-btn-global" hidden accept="image/*" onchange="window.handleMoodImg(this)">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <textarea id="mood-input-text" class="w-full h-24 bg-white border-2 border-slate-800 rounded-2xl p-4 outline-none font-bold text-slate-700 resize-none shadow-inner" placeholder="é€™å¼µç…§ç‰‡ä»£è¡¨äº†ä»€éº¼ï¼Ÿ"></textarea>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-magic btn-style w-full text-sm" onclick="window.addMoodEntry()">å°å­˜æ•…äº‹ âœ¨</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="mood-wall" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 pb-10"></div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="mood-tab-restaurant" class="hidden flex-1 overflow-y-auto p-6 space-y-6">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="bg-slate-50 p-6 rounded-[35px] border-2 border-slate-800 space-y-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-2 gap-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="rest-input-name" class="border-2 border-slate-800 rounded-xl p-3 font-bold" placeholder="é¤å»³åç¨±">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="rest-input-type" class="border-2 border-slate-800 rounded-xl p-3 font-bold" placeholder="ç¾é£Ÿé¡å‹">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center gap-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="font-black text-sm text-slate-500">æ¨è–¦åº¦ï¼š</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="rest-input-stars" class="bg-white border-2 border-slate-800 rounded-xl p-2 font-black text-orange-400">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="5">â­â­â­â­â­</option><option value="4">â­â­â­â­</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="3">â­â­â­</option><option value="2">â­â­</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="1">â­</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-magic btn-style bg-white text-slate-800 border-slate-800 ml-auto" onclick="document.getElementById('rest-img-input-unique').click()">ğŸ“¸ åŠ å…¥ç¾é£Ÿç…§ç‰‡</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="file" id="rest-img-input-unique" hidden accept="image/*" onchange="window.handleRestImg(this)">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <textarea id="rest-input-comment" class="w-full h-20 bg-white border-2 border-slate-800 rounded-2xl p-4 outline-none font-bold text-slate-700 shadow-inner" placeholder="ç”¨é¤é«”é©—åˆ†äº«..."></textarea>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-magic btn-style w-full bg-orange-400 text-white" onclick="window.addRestEntry()">åŠ å…¥è©•é‘‘ ğŸœ</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="rest-wall" class="grid grid-cols-1 md:grid-cols-2 gap-6 pb-10"></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- ğŸ¨ ä½å®¿ç®¡ç† (æ¢å¾©è©³ç´°åˆ†é¡èˆ‡æ¡†æ¶) -->
Â  Â  Â  Â  <div id="hotel-modal" class="hidden hotel-expansion no-scrollbar">
Â  Â  Â  Â  Â  Â  <button class="close-btn-generic btn-style" onclick="window.closeModal()">âœ•</button>
Â  Â  Â  Â  Â  Â  <div class="text-center mb-8"><h2 class="text-3xl font-black">ğŸ¨ ä½å®¿å®‰æ’èˆ‡åœ°åœ–</h2></div>
Â  Â  Â  Â  Â  Â  <div id="hotel-list-container" class="space-y-6"></div>
Â  Â  Â  Â  Â  Â  <div class="text-center mt-6"><button class="btn-magic btn-style bg-yellow-300 text-black px-6" onclick="window.addNewHotel()">ï¼‹ æ–°å¢é£¯åº—è³‡è¨Š</button></div>
Â  Â  Â  Â  Â  Â  <button class="btn-magic btn-style mx-auto my-10 block w-full max-w-lg" onclick="window.saveAllHotels()">ğŸ’¾ å„²å­˜è³‡è¨Š âœ¨</button>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- ğŸ’° æ—…è²»è¨˜å¸³ (æ¢å¾©çµ±è¨ˆåˆè¨ˆ) -->
Â  Â  Â  Â  <div id="money-modal" class="hidden modal-content-base">
Â  Â  Â  Â  Â  Â  <div class="modal-header-generic" style="background:#dcfce7"><h2 class="text-xl font-black text-slate-800">ğŸ’° æ”¯å‡ºçµ±è¨ˆ</h2><button class="btn-magic btn-style bg-white text-black px-4" onclick="window.closeModal()">âœ•</button></div>
Â  Â  Â  Â  Â  Â  <div class="flex-1 overflow-y-auto p-4 space-y-4">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex flex-wrap gap-3 items-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="filter-tab active btn-style" id="tab-all" onclick="window.setExpenseFilter('all')">ğŸ“‹ å…¨éƒ¨</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="filter-tab btn-style" id="tab-personal" onclick="window.setExpenseFilter('personal')">ğŸ™ å€‹äºº <span class="tab-sum" id="sum-personal-tab">HKD 0</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="filter-tab btn-style" id="tab-group" onclick="window.setExpenseFilter('group')">ğŸ‘¥ åœ˜é«” <span class="tab-sum" id="sum-group-tab">HKD 0</span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="sum-grand-badge ml-auto">ğŸ’° åˆè¨ˆ <span id="sum-grand-total">0</span> HKD</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="bg-gray-50 p-4 rounded-3xl flex flex-wrap gap-2 items-center border-2 border-slate-800 shadow-sm">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="fast-cat" class="bg-white border-2 border-slate-800 rounded-xl p-2 font-black text-sm"><option>ğŸ£</option><option>ğŸ›ï¸</option><option>ğŸš‹</option><option>ğŸ¨</option><option>ğŸŸï¸</option></select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="fast-amount" class="flex-1 min-w-[80px] border-2 border-slate-800 rounded-xl px-4 py-2 outline-none text-sm font-bold" placeholder="æ—¥åœ“">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="fast-note" class="flex-1 min-w-[120px] border-2 border-slate-800 rounded-xl px-4 py-2 outline-none text-sm font-bold" placeholder="å‚™è¨»">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="fast-mode" class="border-2 border-slate-800 rounded-xl p-2 font-black text-sm"><option value="personal">ğŸ™ å€‹äºº</option><option value="group">ğŸ‘¥ åœ˜é«”</option></select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-magic btn-style py-2 px-4 shadow-none" onclick="window.saveFastExpense()">ï¼‹</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <table class="w-full"><tbody id="expense-list-body" class="space-y-3 block w-full"></tbody></table>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- ğŸ—ºï¸ è¡Œç¨‹è©³ç´° (æ¢å¾©å…§å®¹) -->
Â  Â  Â  Â  <div id="itinerary-modal" class="hidden modal-content-base">
Â  Â  Â  Â  Â  Â  <div class="modal-header-generic" style="background:#fffde7">
Â  Â  Â  Â  Â  Â  Â  Â  <h2 class="text-xl font-black text-slate-800">ğŸ“œ è¡Œç¨‹è©³ç´°</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex gap-2"><button class="btn-magic btn-style text-xs px-4" onclick="window.saveCurrentDayData()">ğŸ’¾ å„²å­˜</button></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="p-2 border-b border-gray-100 overflow-x-auto bg-slate-50/30 flex gap-2" id="day-tabs-container"></div>
Â  Â  Â  Â  Â  Â  <div class="flex-1 overflow-y-auto p-5">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="timeline-container" id="timeline-blocks-list"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="fixed bottom-10 right-10 z-[50]"><button class="w-14 h-14 bg-yellow-300 rounded-full text-2xl font-black shadow-lg btn-style" onclick="window.addNewBlock()">ï¼‹</button></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- ğŸ›ï¸ è³¼ç‰©æ¸…å–® -->
Â  Â  Â  Â  <div id="shopping-modal" class="hidden modal-content-base">
Â  Â  Â  Â  Â  Â  <div class="modal-header-generic" style="background:#e0f2fe"><h2 class="text-xl font-black text-slate-800">ğŸ›ï¸ è³¼ç‰©æ¸…å–®</h2><button class="btn-magic btn-style bg-white text-black px-4" onclick="window.closeModal()">âœ•</button></div>
Â  Â  Â  Â  Â  Â  <div class="flex-1 overflow-y-auto p-4">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex gap-2 mb-6 bg-slate-50 p-4 rounded-3xl border-2 border-slate-800">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="shop-input-text-val" class="flex-1 bg-transparent outline-none font-bold" placeholder="æƒ³è¦è²·ä»€éº¼ï¼Ÿ">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="text-xl" onclick="document.getElementById('shop-file-input-unique').click()">ğŸ“·</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="file" id="shop-file-input-unique" hidden accept="image/*" onchange="window.handleShopImg(this)">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn-magic btn-style px-6" onclick="window.addShopItem()">ï¼‹</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="shop-list-wall" class="space-y-3"></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- âœˆï¸ èˆªç­ç¥¨åˆ¸æ¢å¾© -->
Â  Â  Â  Â  <div id="flight-modal" class="hidden pink-vintage-ticket m-auto shadow-2xl">
Â  Â  Â  Â  Â  Â  <button class="close-ticket absolute top-4 right-4 font-black text-xl" onclick="window.closeModal()">âœ•</button>
Â  Â  Â  Â  Â  Â  <div class="ticket-main-title">âœ¨ MAGIC PASS âœ¨</div>
Â  Â  Â  Â  Â  Â  <div class="ticket-body">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="ticket-section">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="pink-tag btn-style">DEPARTURE / å»ç¨‹</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ticket-field"><label>FLIGHT NO.</label><div contenteditable="true" class="edit-text" id="flight-out-no">BR198</div></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ticket-field"><label>TIME</label><div contenteditable="true" class="edit-text" id="flight-out-time">08:30</div></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ticket-field"><label>PRICE (HKD)</label><div contenteditable="true" class="edit-text" id="flight-out-price">12,500</div></div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="ticket-perforation"><div class="cutout top"></div><div class="line"></div><div class="cutout bottom"></div></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="ticket-section">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="pink-tag btn-style">RETURN / å›ç¨‹</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ticket-field"><label>FLIGHT NO.</label><div contenteditable="true" class="edit-text" id="flight-in-no">BR197</div></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ticket-field"><label>TIME</label><div contenteditable="true" class="edit-text" id="flight-in-time">14:15</div></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="ticket-field"><label>PRICE (HKD)</label><div contenteditable="true" class="edit-text" id="flight-in-price">11,000</div></div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <button class="btn-magic btn-style mx-auto mb-8 block px-10" onclick="window.saveFlightDetails()">ç¢ºèªåŒæ­¥ âœ¨</button>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- ğŸ“š åƒè€ƒè³‡æ–™æ¢å¾© -->
Â  Â  Â  Â  <div id="reference-modal" class="hidden modal-content-base">
Â  Â  Â  Â  Â  Â  <div class="modal-header-generic" style="background:#ccfbf1"><h2 class="text-xl font-black text-slate-800">ğŸ“š åƒè€ƒåº«</h2><div class="flex gap-2"><button class="btn-magic btn-style text-xs px-3" onclick="window.addNewRefCard()">ï¼‹ æ–°å¢åˆ†é¡</button></div></div>
Â  Â  Â  Â  Â  Â  <div class="flex-1 overflow-y-auto p-5 grid grid-cols-1 md:grid-cols-2 gap-6" id="ref-cards-container"></div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- ğŸ’ è¡Œå‰æ¸…å–® -->
Â  Â  Â  Â  <div id="prep-modal" class="hidden modal-content-base">
Â  Â  Â  Â  Â  Â  <div class="modal-header-generic" style="background:#fef3c7"><h2 class="text-xl font-black text-slate-800">ğŸ’ è¡Œå‰æ¸…å–®</h2><button class="btn-magic btn-style bg-white text-black px-4" onclick="window.closeModal()">âœ•</button></div>
Â  Â  Â  Â  Â  Â  <div class="flex-1 overflow-y-auto p-6 grid grid-cols-1 md:grid-cols-2 gap-6">
Â  Â  Â  Â  Â  Â  Â  Â  <div><h3 class="font-black mb-3 italic text-sm">ğŸ« è»Šç¥¨é–€ç¥¨</h3><div class="flex gap-2 mb-4"><input type="text" id="prep-input-ticket" class="flex-1 border-2 border-slate-800 rounded-xl px-4 py-2 text-sm" placeholder="æ–°å¢é …ç›®..."><button class="btn-magic btn-style py-2 px-4 shadow-none" onclick="window.addPrepItem('ticket')">ï¼‹</button></div><div id="prep-list-ticket" class="space-y-2"></div></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div><h3 class="font-black mb-3 italic text-sm">ğŸ§³ å…¶ä»–è¡Œæ</h3><div class="flex gap-2 mb-4"><input type="text" id="prep-input-luggage" class="flex-1 border-2 border-slate-800 rounded-xl px-4 py-2 text-sm" placeholder="æ–°å¢é …ç›®..."><button class="btn-magic btn-style py-2 px-4 shadow-none" onclick="window.addPrepItem('luggage')">ï¼‹</button></div><div id="prep-list-luggage" class="space-y-2"></div></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <!-- åœ–ç‰‡é è¦½ç‡ˆç®± -->
Â  Â  <div id="shop-preview-overlay" class="fixed inset-0 bg-black/90 z-[5000] hidden items-center justify-center p-10 cursor-zoom-out" onclick="this.style.display='none'"><img id="shop-preview-img" class="max-w-full max-h-full rounded-lg border-2 border-white shadow-2xl" src=""></div>

Â  Â  <script>
Â  Â  Â  Â  // ==========================================
Â  Â  Â  Â  // å…¨åŸŸå®šç¾©èˆ‡ä¿®å¾© - å„ªå…ˆå®šç¾©å­æ¸²æŸ“å‡½å¼ (è§£æ±º ReferenceError)
Â  Â  Â  Â  // ==========================================
Â  Â  Â  Â 
Â  Â  Â  Â  const RATE_HKD = 0.051;
Â  Â  Â  Â  const ACT_TYPES = ['ğŸ°', 'ğŸ±', 'ğŸ›ï¸', 'ğŸš‹', 'â˜•', 'ğŸ¨'];
Â  Â  Â  Â  const ACT_LABELS = { 'ğŸ°': 'æ™¯é»', 'ğŸ±': 'ç¾é£Ÿ', 'ğŸ›ï¸': 'è³¼ç‰©', 'ğŸš‹': 'äº¤é€š', 'â˜•': 'ä¼‘æ¯', 'ğŸ¨': 'é£¯åº—' };
Â  Â  Â  Â  const ACT_COLORS = { 'ğŸ°': '#e1f5fe', 'ğŸ±': '#fff9c4', 'ğŸ›ï¸': '#fce4ec', 'ğŸš‹': '#f1f8e9', 'â˜•': '#f3e5f5', 'ğŸ¨': '#e8eaf6' };

Â  Â  Â  Â  let currentDay = 1;
Â  Â  Â  Â  let itineraryData = {};
Â  Â  Â  Â  let pendingShopImg = "";
Â  Â  Â  Â  let pendingMoodImg = "";
Â  Â  Â  Â  let pendingRestImg = "";
Â  Â  Â  Â  let calcInput = "0"; let calcBuffer = 0; let calcPendingOp = null; let calcJustSolved = false; let calcFormula = "";

Â  Â  Â  Â  // --- å…¨åŸŸå·¥å…· ---
Â  Â  Â  Â  window.formatMapUrl = function(input) { if (!input) return ""; const srcMatch = input.match(/src="([^"]+)"/); if (srcMatch && srcMatch[1]) return srcMatch[1]; if (input.startsWith('http')) return input; return `https://maps.google.com/maps?q=${encodeURIComponent(input)}&output=embed`; };
Â  Â  Â  Â  window.saveDayToMemory = function(day) { const blks = []; const list = document.querySelectorAll('#timeline-blocks-list .activity-sticker'); if(list.length > 0) { list.forEach(el => { blks.push({ type:'activity', cat:el.dataset.cat, time:el.querySelector('.act-time-input').value, name:el.querySelector('.act-name-input').innerText, content:el.querySelector('.act-content-input').innerText, url:el.querySelector('.act-map-input').value, showMap:el.querySelector('.map-embed-container').style.display==='block'}); }); itineraryData[day] = blks; } };

Â  Â  Â  Â  // --- å­æ¸²æŸ“å‡½å¼ (æ ¸å¿ƒä¿®å¾©) ---
Â  Â  Â  Â  window.zoomShopImg = function(s) { document.getElementById('shop-preview-img').src = s; document.getElementById('shop-preview-overlay').style.display = 'flex'; };
Â  Â  Â  Â 
Â  Â  Â  Â  window.renderShopItem = function(item) {
Â  Â  Â  Â  Â  Â  const w = document.getElementById('shop-list-wall');
Â  Â  Â  Â  Â  Â  if(!w) return;
Â  Â  Â  Â  Â  Â  const div = document.createElement('div'); div.className = `p-3 bg-white rounded-2xl flex items-center gap-4 border-2 border-slate-200 ${item.checked ? 'opacity-30' : ''} shadow-sm`;
Â  Â  Â  Â  Â  Â  div.innerHTML = `<div class="w-8 h-8 border-2 border-slate-800 rounded-xl flex items-center justify-center font-black cursor-pointer ${item.checked ? 'bg-green-400 text-white border-none' : 'bg-white'}" onclick="window.toggleShopItem(${item.id})">${item.checked ? 'âœ“' : ''}</div>${item.img ? `<img src="${item.img}" class="w-11 h-11 rounded-lg object-cover shadow-sm cursor-zoom-in" onclick="window.zoomShopImg('${item.img}')">` : '<div class="w-11 h-11 bg-slate-100 rounded-lg"></div>'}<div class="flex-1 font-bold text-xs ${item.checked ? 'line-through text-slate-400' : ''}">${item.text}</div><div class="text-slate-300 cursor-pointer hover:text-red-500 font-bold" onclick="window.delShopItem(${item.id})">âœ•</div>`;
Â  Â  Â  Â  Â  Â  w.prepend(div);
Â  Â  Â  Â  };

Â  Â  Â  Â  // --- åŸºç¤ UI ---
Â  Â  Â  Â  window.openModal = function(id) {
Â  Â  Â  Â  Â  Â  document.getElementById('modal-container').style.display = 'flex';
Â  Â  Â  Â  Â  Â  document.querySelectorAll('#modal-container > div').forEach(d => d.classList.add('hidden'));
Â  Â  Â  Â  Â  Â  const target = document.getElementById(id);
Â  Â  Â  Â  Â  Â  if(target) target.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  if(id === 'itinerary-modal') window.switchDay(currentDay);
Â  Â  Â  Â  };
Â  Â  Â  Â  window.closeModal = function() { document.getElementById('modal-container').style.display = 'none'; };
Â  Â  Â  Â  window.showToast = function(m) { const t = document.getElementById('toast'); if(t) { t.innerText = m; t.classList.remove('opacity-0'); t.classList.add('opacity-100'); setTimeout(() => { t.classList.remove('opacity-100'); t.classList.add('opacity-0'); }, 2000); } };
Â  Â  Â  Â  window.saveMainData = function() { localStorage.setItem('main-trip-title', document.getElementById('main-trip-title').innerText); localStorage.setItem('main-trip-date', document.getElementById('main-trip-date').innerText); window.showToast('æ‘˜è¦å·²æ›´æ–° âœ¨'); };

Â  Â  Â  Â  // --- ğŸ§® è¨ˆç®—æ©Ÿ ---
Â  Â  Â  Â  window.toggleCalc = function() { const p = document.getElementById('calc-panel'); p.style.display = (p.style.display === 'flex' ? 'none' : 'flex'); };
Â  Â  Â  Â  window.appendCalc = function(v) { if(calcJustSolved) { calcInput = (v === "." ? "0." : v); calcFormula = ""; calcJustSolved = false; } else { if(calcInput === "0" && v !== ".") calcInput = v; else calcInput += v; } updateCalcDisplay(); };
Â  Â  Â  Â  window.setCalcOp = function(op) { if(calcPendingOp && !calcJustSolved) window.solveCalc(); calcBuffer = parseFloat(calcInput) || 0; calcPendingOp = op; calcFormula = calcBuffer + " " + op + " "; calcJustSolved = true; updateCalcDisplay(); };
Â  Â  Â  Â  window.solveCalc = function() { if(!calcPendingOp) return; const cur = parseFloat(calcInput) || 0; let res = 0; if(calcPendingOp === '+') res = calcBuffer + cur; else if(calcPendingOp === '-') res = calcBuffer - cur; calcFormula = calcBuffer + " " + calcPendingOp + " " + cur + " ="; calcInput = res.toString(); calcPendingOp = null; calcJustSolved = true; updateCalcDisplay(); };
Â  Â  Â  Â  window.clearCalc = function() { calcInput = "0"; calcBuffer = 0; calcPendingOp = null; calcJustSolved = false; calcFormula = ""; updateCalcDisplay(); };
Â  Â  Â  Â  function updateCalcDisplay() { document.getElementById('calc-jpy-val').innerText = calcInput; document.getElementById('calc-formula-display').innerText = calcFormula; document.getElementById('calc-hkd-val').innerText = (parseFloat(calcInput) * RATE_HKD).toFixed(2); }

Â  Â  Â  Â  // --- ğŸ’– å¿ƒæƒ… & ğŸ´ é¤å»³ ---
Â  Â  Â  Â  window.switchMoodTab = function(tab) {
Â  Â  Â  Â  Â  Â  document.getElementById('mood-tab-diary').classList.toggle('hidden', tab !== 'diary');
Â  Â  Â  Â  Â  Â  document.getElementById('mood-tab-restaurant').classList.toggle('hidden', tab !== 'restaurant');
Â  Â  Â  Â  Â  Â  document.getElementById('btn-tab-diary').classList.toggle('opacity-50', tab !== 'diary');
Â  Â  Â  Â  Â  Â  document.getElementById('btn-tab-rest').classList.toggle('opacity-50', tab !== 'restaurant');
Â  Â  Â  Â  Â  Â  document.getElementById('btn-tab-diary').classList.toggle('underline', tab === 'diary');
Â  Â  Â  Â  Â  Â  document.getElementById('btn-tab-rest').classList.toggle('underline', tab === 'restaurant');
Â  Â  Â  Â  };
Â  Â  Â  Â  window.handleMoodImg = function(i) { if(i.files && i.files[0]) { const r = new FileReader(); r.onload = ev => { pendingMoodImg = ev.target.result; window.showToast("ç…§ç‰‡å·²è¼‰å…¥ç´€å¿µå†Š âœ¨"); }; r.readAsDataURL(i.files[0]); } };
Â  Â  Â  Â  window.addMoodEntry = function() {
Â  Â  Â  Â  Â  Â  const text = document.getElementById('mood-input-text').value;
Â  Â  Â  Â  Â  Â  const emojiSelection = document.getElementById('mood-input-emoji').value;
Â  Â  Â  Â  Â  Â  const emoji = emojiSelection.split(' ')[0];
Â  Â  Â  Â  Â  Â  const date = document.getElementById('mood-input-date').value;
Â  Â  Â  Â  Â  Â  if(!text && !pendingMoodImg) return;
Â  Â  Â  Â  Â  Â  const entry = { id: Date.now(), text, emoji, img: pendingMoodImg, date: date || new Date().toLocaleDateString() };
Â  Â  Â  Â  Â  Â  const saved = JSON.parse(localStorage.getItem('trip-moods-v1') || '[]');
Â  Â  Â  Â  Â  Â  saved.unshift(entry); localStorage.setItem('trip-moods-v1', JSON.stringify(saved));
Â  Â  Â  Â  Â  Â  document.getElementById('mood-input-text').value = ""; pendingMoodImg = "";
Â  Â  Â  Â  Â  Â  loadMoodEntries(); window.showToast("å¿ƒæƒ…å·²å°å­˜ ğŸ’–");
Â  Â  Â  Â  };
Â  Â  Â  Â  function loadMoodEntries() {
Â  Â  Â  Â  Â  Â  const saved = JSON.parse(localStorage.getItem('trip-moods-v1') || '[]');
Â  Â  Â  Â  Â  Â  const wall = document.getElementById('mood-wall'); if(!wall) return; wall.innerHTML = "";
Â  Â  Â  Â  Â  Â  saved.forEach(e => {
Â  Â  Â  Â  Â  Â  Â  Â  const div = document.createElement('div'); div.className = "polaroid-frame bg-white relative";
Â  Â  Â  Â  Â  Â  Â  Â  div.innerHTML = `<div class="absolute -top-3 -right-3 w-8 h-8 bg-white border-2 border-slate-800 rounded-full flex items-center justify-center font-black cursor-pointer shadow-sm btn-style" onclick="window.deleteMood(${e.id})">âœ•</div>${e.img ? `<img src="${e.img}" class="polaroid-img" onclick="window.zoomShopImg('${e.img}')">` : '<div class="polaroid-img flex items-center justify-center text-5xl bg-slate-50">'+e.emoji+'</div>'}<div class="polaroid-caption">${e.emoji} ${e.date}</div><div class="px-2 mt-2 text-xs font-bold text-slate-500 leading-relaxed">${e.text}</div>`;
Â  Â  Â  Â  Â  Â  Â  Â  wall.appendChild(div);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }
Â  Â  Â  Â  window.deleteMood = function(id) { let saved = JSON.parse(localStorage.getItem('trip-moods-v1') || '[]'); saved = saved.filter(e => e.id !== id); localStorage.setItem('trip-moods-v1', JSON.stringify(saved)); loadMoodEntries(); };

Â  Â  Â  Â  window.handleRestImg = function(i) { if(i.files && i.files[0]) { const r = new FileReader(); r.onload = ev => { pendingRestImg = ev.target.result; window.showToast("ç¾é£Ÿç…§å·²æº–å‚™ âœ¨"); }; r.readAsDataURL(i.files[0]); } };
Â  Â  Â  Â  window.addRestEntry = function() {
Â  Â  Â  Â  Â  Â  const name = document.getElementById('rest-input-name').value;
Â  Â  Â  Â  Â  Â  const type = document.getElementById('rest-input-type').value;
Â  Â  Â  Â  Â  Â  const stars = document.getElementById('rest-input-stars').value;
Â  Â  Â  Â  Â  Â  const comment = document.getElementById('rest-input-comment').value;
Â  Â  Â  Â  Â  Â  if(!name) { window.showToast("è«‹è¼¸å…¥é¤å»³åç¨±"); return; }
Â  Â  Â  Â  Â  Â  const item = { id: Date.now(), name, type, stars, comment, img: pendingRestImg };
Â  Â  Â  Â  Â  Â  const saved = JSON.parse(localStorage.getItem('trip-rests-v1') || '[]');
Â  Â  Â  Â  Â  Â  saved.unshift(item); localStorage.setItem('trip-rests-v1', JSON.stringify(saved));
Â  Â  Â  Â  Â  Â  document.getElementById('rest-input-name').value = ""; document.getElementById('rest-input-type').value = ""; document.getElementById('rest-input-comment').value = ""; pendingRestImg = "";
Â  Â  Â  Â  Â  Â  loadRestEntries(); window.showToast("ç¾é£Ÿç´€éŒ„å·²æ›´æ–° ğŸœ");
Â  Â  Â  Â  };
Â  Â  Â  Â  function loadRestEntries() {
Â  Â  Â  Â  Â  Â  const saved = JSON.parse(localStorage.getItem('trip-rests-v1') || '[]');
Â  Â  Â  Â  Â  Â  const wall = document.getElementById('rest-wall'); if(!wall) return; wall.innerHTML = "";
Â  Â  Â  Â  Â  Â  saved.forEach(e => {
Â  Â  Â  Â  Â  Â  Â  Â  const starsHtml = 'â­'.repeat(parseInt(e.stars));
Â  Â  Â  Â  Â  Â  Â  Â  const div = document.createElement('div'); div.className = "rest-card card-shape btn-style";
Â  Â  Â  Â  Â  Â  Â  Â  div.innerHTML = `<div class="flex justify-between items-start"><h4 class="font-black text-slate-800">${e.name} <span class="text-[10px] text-slate-400">#${e.type}</span></h4><div class="cursor-pointer text-slate-300 font-bold" onclick="window.deleteRest(${e.id})">âœ•</div></div>${e.img ? `<img src="${e.img}" class="rest-img-preview" onclick="window.zoomShopImg('${e.img}')">` : ''}<div class="star-rating">${starsHtml}</div><div class="text-[10px] font-bold text-slate-500 italic leading-relaxed">${e.comment}</div>`;
Â  Â  Â  Â  Â  Â  Â  Â  wall.appendChild(div);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }
Â  Â  Â  Â  window.deleteRest = function(id) { let saved = JSON.parse(localStorage.getItem('trip-rests-v1') || '[]'); saved = saved.filter(e => e.id !== id); localStorage.setItem('trip-rests-v1', JSON.stringify(saved)); loadRestEntries(); };

Â  Â  Â  Â  // --- ğŸ—ºï¸ è¡Œç¨‹è©³ç´°è¦åŠƒ ---
Â  Â  Â  Â  window.saveTabDate = function(day, d) { const s = JSON.parse(localStorage.getItem('trip-tab-dates') || '{}'); s[day] = d; localStorage.setItem('trip-tab-dates', JSON.stringify(s)); };
Â  Â  Â  Â  window.initDayTabs = function() {
Â  Â  Â  Â  Â  Â  const container = document.getElementById('day-tabs-container'); if(!container) return;
Â  Â  Â  Â  Â  Â  container.innerHTML = '';
Â  Â  Â  Â  Â  Â  const savedDates = JSON.parse(localStorage.getItem('trip-tab-dates') || '{}');
Â  Â  Â  Â  Â  Â  const defDates = ['8/1','9/1','10/1','11/1','12/1','13/1','14/1'];
Â  Â  Â  Â  Â  Â  for (let i = 1; i <= 7; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  const tab = document.createElement('div'); tab.className = `day-tab btn-style ${i === currentDay ? 'active' : ''}`;
Â  Â  Â  Â  Â  Â  Â  Â  tab.innerHTML = `<div onclick="window.switchDay(${i})">Day ${i}</div><div contenteditable="true" class="text-[10px] opacity-70" onblur="window.saveTabDate(${i}, this.innerText)" onclick="event.stopPropagation()">${savedDates[i] || defDates[i-1]}</div>`;
Â  Â  Â  Â  Â  Â  Â  Â  container.appendChild(tab);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  };
Â  Â  Â  Â  window.switchDay = function(day) { window.saveDayToMemory(currentDay); currentDay = day; window.initDayTabs(); const container = document.getElementById('timeline-blocks-list'); if(!container) return; container.innerHTML = ''; const blocks = itineraryData[day] || [{ type: 'activity', cat: 'ğŸ°', time: '09:00', name: 'æ¢ç´¢è¡Œç¨‹', content: 'å…§å®¹...', url: '', showMap: false }]; blocks.forEach(block => renderBlock(block)); };
Â  Â  Â  Â  function renderBlock(block) {
Â  Â  Â  Â  Â  Â  const container = document.getElementById('timeline-blocks-list'); const wrapper = document.createElement('div'); wrapper.className = 'timeline-block'; const bgColor = ACT_COLORS[block.cat] || '#fff';
Â  Â  Â  Â  Â  Â  let drp = ACT_TYPES.map(type => `<div class="type-opt-item ${block.cat === type ? 'active' : ''}" onclick="window.selectActType(this, '${type}')"><span>${type}</span><span>${ACT_LABELS[type]}</span></div>`).join('');
Â  Â  Â  Â  Â  Â  wrapper.innerHTML = `<div class="activity-sticker" style="background: ${bgColor}" data-cat="${block.cat}"><div class="remove-block-btn" onclick="this.parentElement.parentElement.remove()">âœ•</div><div class="act-top-row flex items-center gap-3"><div style="position:relative"><div class="act-type-display w-[45px] h-[45px] border-2 border-slate-800 rounded-xl flex items-center justify-center text-xl bg-white cursor-pointer btn-style" onclick="this.nextElementSibling.classList.toggle('show')">${block.cat}</div><div class="type-dropdown-list">${drp}</div></div><input type="text" class="act-time-input border-2 border-slate-800 bg-slate-800 text-white text-[10px] rounded-full px-3 py-1 w-20" value="${block.time}"><div class="act-name-input text-slate-800 font-black flex-1 outline-none" contenteditable="true">${block.name}</div></div><div class="act-content-input outline-none min-h-[60px] bg-white/40 p-3 rounded-xl text-[0.8rem] italic my-2 border border-slate-200/50" contenteditable="true">${block.content}</div><div class="flex gap-2 mt-2"><input type="text" class="act-map-input flex-1 text-[10px] border-2 border-slate-800 rounded-lg p-2 outline-none" value="${block.url}" placeholder="è¼¸å…¥åœ°åœ–ç¢¼"><button class="bg-slate-800 text-white text-[9px] px-3 rounded-lg py-1 font-black btn-style" onclick="window.generateMap(this)">ç”Ÿæˆ</button></div><div class="map-embed-container" style="display: ${block.showMap ? 'block' : 'none'}"><button class="close-map-btn" onclick="this.parentElement.style.display='none'">âœ•</button><iframe src="${window.formatMapUrl(block.url)}" width="100%" height="250" style="border:0;" allowfullscreen="" loading="lazy"></iframe></div></div>`;
Â  Â  Â  Â  Â  Â  container.appendChild(wrapper);
Â  Â  Â  Â  }
Â  Â  Â  Â  window.selectActType = function(opt, type) { const wrap = opt.closest('.activity-sticker'); wrap.querySelector('.act-type-display').innerText = type; wrap.dataset.cat = type; wrap.style.background = ACT_COLORS[type]; opt.parentElement.classList.remove('show'); };
Â  Â  Â  Â  window.generateMap = function(btn) { const sticker = btn.closest('.activity-sticker'); const val = sticker.querySelector('.act-map-input').value; const container = sticker.querySelector('.map-embed-container'); if(!val) return; container.querySelector('iframe').src = window.formatMapUrl(val); container.style.display = 'block'; };
Â  Â  Â  Â  window.addNewBlock = function() { renderBlock({ type: 'activity', cat: 'ğŸ°', time: '12:00', name: 'æ–°æ™¯é»', content: 'å…§å®¹...', url: '', showMap: false }); };
Â  Â  Â  Â  window.saveCurrentDayData = function() { window.saveDayToMemory(currentDay); localStorage.setItem('trip-itinerary-v17', JSON.stringify(itineraryData)); window.showToast("è¡Œç¨‹å·²å­˜æª”ï¼âœ¨"); };

Â  Â  Â  Â  // --- ğŸ’° è¨˜å¸³æœ¬ ---
Â  Â  Â  Â  window.loadMExpenses = function(f = 'all') {
Â  Â  Â  Â  Â  Â  const s = JSON.parse(localStorage.getItem('trip-money-v6') || '[]');
Â  Â  Â  Â  Â  Â  const body = document.getElementById('expense-list-body'); if(!body) return;
Â  Â  Â  Â  Â  Â  body.innerHTML = ""; let p = 0, g = 0;
Â  Â  Â  Â  Â  Â  s.forEach(e => { const val = parseFloat(e.hkd); if(e.mode === 'personal') p += val; else g += val; if(f === 'all' || f === e.mode) renderRow(e); });
Â  Â  Â  Â  Â  Â  const ps = document.getElementById('sum-personal-tab'); if(ps) ps.innerText = `HKD ${p.toFixed(0)}`;
Â  Â  Â  Â  Â  Â  const gs = document.getElementById('sum-group-tab'); if(gs) gs.innerText = `HKD ${g.toFixed(0)}`;
Â  Â  Â  Â  Â  Â  const gt = document.getElementById('sum-grand-total'); if(gt) gt.innerText = (p+g).toFixed(0);
Â  Â  Â  Â  };
Â  Â  Â  Â  window.setExpenseFilter = function(f) { document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active')); document.getElementById(`tab-${f}`).classList.add('active'); window.loadMExpenses(f); };
Â  Â  Â  Â  window.saveFastExpense = function() { const aVal = document.getElementById('fast-amount').value; const a = parseFloat(aVal.replace(/,/g, '')); if(isNaN(a) || a <= 0) return; const item = { id: Date.now(), cat: document.getElementById('fast-cat').value, note: document.getElementById('fast-note').value || "æ”¯å‡º", mode: document.getElementById('fast-mode').value, jpy: a, hkd: (a * RATE_HKD).toFixed(2), time: new Date().toLocaleTimeString([], { hour:'2-digit', minute:'2-digit'}) }; const s = JSON.parse(localStorage.getItem('trip-money-v6') || '[]'); s.unshift(item); localStorage.setItem('trip-money-v6', JSON.stringify(s)); document.getElementById('fast-amount').value = ""; document.getElementById('fast-note').value = ""; window.loadMExpenses(); };

Â  Â  Â  Â  // --- ğŸ¨ ä½å®¿ & âœˆï¸ èˆªç­ ---
Â  Â  Â  Â  window.addNewHotel = function(d = { days: 'æ—¥æœŸç¯„åœ', name: 'é£¯åº—', address: 'åœ°å€', trans: 'äº¤é€š', img: '' }) {
Â  Â  Â  Â  Â  Â  const container = document.getElementById('hotel-list-container'); const entry = document.createElement('div'); entry.className = 'hotel-entry btn-style';
Â  Â  Â  Â  Â  Â  entry.innerHTML = `<div class="hotel-info-side"><div class="day-badge btn-style" contenteditable="true" style="background:var(--magic-yellow); padding:5px 12px; border-radius:10px; font-weight:900; display:inline-block; margin-bottom:15px; font-size:0.7rem;">${d.days}</div><div class="hotel-category-box"><span class="hotel-cat-label" style="background:#7986cb">ğŸ¨ é…’åº—åç¨±</span><div contenteditable="true" class="hotel-edit-val hotel-name-val">${d.name}</div></div><div class="hotel-category-box"><span class="hotel-cat-label" style="background:#4fc3f7">ğŸ“ è©³ç´°åœ°å€</span><div contenteditable="true" class="hotel-edit-val hotel-addr-val">${d.address}</div></div><div class="hotel-category-box"><span class="hotel-cat-label" style="background:#ffb74d">ğŸšŒ äº¤é€šæ–¹æ³•</span><div contenteditable="true" class="hotel-edit-val hotel-trans-val">${d.trans}</div></div></div><div class="photo-side"><div class="big-photo-frame btn-style" onclick="this.querySelector('input').click()"><img src="${d.img || 'https://via.placeholder.com/400x300?text=ç›¸ç‰‡'}" class="preview-img"><input type="file" hidden onchange="if(this.files[0]){const r=new FileReader(); r.onload=ev=>this.parentElement.querySelector('img').src=ev.target.result; r.readAsDataURL(this.files[0]);}"></div></div><button onclick="this.parentElement.remove()" class="absolute top-4 right-4 bg-white/80 w-8 h-8 rounded-full border-2 border-slate-800 font-bold text-sm">âœ•</button>`;
Â  Â  Â  Â  Â  Â  if(container) container.appendChild(entry);
Â  Â  Â  Â  };
Â  Â  Â  Â  window.saveAllHotels = function() { const list = []; document.querySelectorAll('.hotel-entry').forEach(e => { list.push({ days: e.querySelector('.day-badge').innerText, name: e.querySelector('.hotel-name-val').innerText, address: e.querySelector('.hotel-addr-val').innerText, trans: e.querySelector('.hotel-trans-val').innerText, img: e.querySelector('img').src }); }); localStorage.setItem('trip-hotels-v4', JSON.stringify(list)); updateSummaryDisplay(); window.closeModal(); window.showToast("ä½å®¿æ›´æ–°å®Œç•¢"); };
Â  Â  Â  Â  window.saveFlightDetails = function() { ['flight-out-no', 'flight-out-time', 'flight-out-price', 'flight-in-no', 'flight-in-time', 'flight-in-price'].forEach(id => { const el = document.getElementById(id); if (el) localStorage.setItem(id, el.innerText); }); updateSummaryDisplay(); window.closeModal(); window.showToast("æ©Ÿç¥¨å·²åŒæ­¥"); };
Â  Â  Â  Â  window.loadHotels = function() { const s = localStorage.getItem('trip-hotels-v4'); if(s) { const c = document.getElementById('hotel-list-container'); if(c) { c.innerHTML = ""; JSON.parse(s).forEach(h => window.addNewHotel(h)); } } else window.addNewHotel(); };

Â  Â  Â  Â  // --- ğŸ›ï¸ & ğŸ’ & ğŸ“š ---
Â  Â  Â  Â  window.loadShopping = function() { const s = JSON.parse(localStorage.getItem('trip-shopping-v1') || '[]'); const w = document.getElementById('shop-list-wall'); if(!w) return; w.innerHTML = ""; s.forEach(i => window.renderShopItem(i)); };
Â  Â  Â  Â  window.addShopItem = function() { const t = document.getElementById('shop-input-text-val').value; if(!t) return; const item = { id: Date.now(), text: t, img: pendingShopImg, checked: false }; const s = JSON.parse(localStorage.getItem('trip-shopping-v1') || '[]'); s.push(item); localStorage.setItem('trip-shopping-v1', JSON.stringify(s)); window.loadShopping(); document.getElementById('shop-input-text-val').value = ""; pendingShopImg = ""; };
Â  Â  Â  Â  window.handleShopImg = function(i) { if(i.files && i.files[0]) { const r = new FileReader(); r.onload = ev => { pendingShopImg = ev.target.result; window.showToast("ç›¸ç‰‡å·²æº–å‚™ âœ¨"); }; r.readAsDataURL(i.files[0]); } };
Â  Â  Â  Â  window.toggleShopItem = function(id) { let s = JSON.parse(localStorage.getItem('trip-shopping-v1') || '[]'); const idx = s.findIndex(i => i.id === id); if(idx > -1) { s[idx].checked = !s[idx].checked; localStorage.setItem('trip-shopping-v1', JSON.stringify(s)); window.loadShopping(); } };
Â  Â  Â  Â  window.delShopItem = function(id) { let s = JSON.parse(localStorage.getItem('trip-shopping-v1') || '[]'); s = s.filter(i => i.id !== id); localStorage.setItem('trip-shopping-v1', JSON.stringify(s)); window.loadShopping(); };

Â  Â  Â  Â  window.loadPrep = function() { const s = JSON.parse(localStorage.getItem('trip-prep-v1') || '[]'); const lt = document.getElementById('prep-list-ticket'); const lg = document.getElementById('prep-list-luggage'); if(lt) lt.innerHTML = ""; if(lg) lg.innerHTML = ""; s.forEach(i => renderPrepItem(i)); };
Â  Â  Â  Â  window.addPrepItem = function(cat) { const i = document.getElementById(`prep-input-${cat}`); if(!i.value) return; const item = { id: Date.now(), category: cat, text: i.value, checked: false }; const s = JSON.parse(localStorage.getItem('trip-prep-v1') || '[]'); s.push(item); localStorage.setItem('trip-prep-v1', JSON.stringify(s)); window.loadPrep(); i.value = ""; };
Â  Â  Â  Â  function renderPrepItem(item) { const l = document.getElementById(`prep-list-${item.category}`); if(!l) return; const div = document.createElement('div'); div.className = `p-2.5 bg-white rounded-xl flex items-center gap-3 border-2 border-slate-200 ${item.checked ? 'opacity-40 grayscale' : ''} shadow-sm`; div.innerHTML = `<div class="w-6 h-6 border-2 border-slate-800 rounded flex items-center justify-center cursor-pointer ${item.checked ? 'bg-green-400 border-none text-white' : 'bg-white'}" onclick="window.togglePrepItem(${item.id})">${item.checked ? 'âœ“' : ''}</div><div class="flex-1 font-bold text-xs ${item.checked ? 'line-through' : ''}">${item.text}</div><div class="text-gray-300 cursor-pointer" onclick="window.delPrepItem(${item.id})">âœ•</div>`; l.appendChild(div); }
Â  Â  Â  Â  window.togglePrepItem = function(id) { let s = JSON.parse(localStorage.getItem('trip-prep-v1') || '[]'); const idx = s.findIndex(i => i.id === id); if(idx > -1) { s[idx].checked = !s[idx].checked; localStorage.setItem('trip-prep-v1', JSON.stringify(s)); window.loadPrep(); } };
Â  Â  Â  Â  window.delPrepItem = function(id) { let s = JSON.parse(localStorage.getItem('trip-prep-v1') || '[]'); s = s.filter(i => i.id !== id); localStorage.setItem('trip-prep-v1', JSON.stringify(s)); window.loadPrep(); };

Â  Â  Â  Â  window.loadRefCards = function() { const s = localStorage.getItem('trip-ref-cards-v1'); const c = document.getElementById('ref-cards-container'); if(!c) return; c.innerHTML = ""; if(s) JSON.parse(s).forEach(card => window.addNewRefCard(card)); else window.addNewRefCard({title:"ä½å®¿ç¯„æœ¬",content:"ç·¨è¼¯æ‚¨çš„ç­†è¨˜..."}); };
Â  Â  Â  Â  window.addNewRefCard = function(d = { title: "æ–°åˆ†é¡", content: "" }) { const c = document.getElementById('ref-cards-container'); if(!c) return; const div = document.createElement('div'); div.className = 'ref-card btn-style bg-[#fffdf5] p-5 flex flex-col gap-3 relative'; div.innerHTML = `<div class="flex justify-between border-b-2 border-dashed border-slate-300 pb-2"><div class="text-slate-800 font-black outline-none ref-card-title" contenteditable="true" onblur="window.saveRefCards()">${d.title}</div><div class="cursor-pointer text-slate-300 font-bold" onclick="this.closest('.ref-card').remove(); window.saveRefCards();">âœ•</div></div><div class="text-slate-500 text-xs outline-none min-h-[100px] leading-relaxed" contenteditable="true" onblur="window.saveRefCards()">${d.content}</div>`; c.appendChild(div); };
Â  Â  Â  Â  window.saveRefCards = function() { const cards = []; document.querySelectorAll('#ref-cards-container > .ref-card').forEach(el => { cards.push({ title: el.querySelector('.ref-card-title').innerText, content: el.querySelector('.ref-card-body').innerText }); }); localStorage.setItem('trip-ref-cards-v1', JSON.stringify(cards)); };

Â  Â  Â  Â  // --- å…¨åŸŸè¼‰å…¥èˆ‡åŒæ­¥ ---
Â  Â  Â  Â  function updateSummaryDisplay() { const outNo = localStorage.getItem('flight-out-no') || 'BR 198'; document.getElementById('main-flight-summary').innerText = `${outNo} / 197`; const hCount = JSON.parse(localStorage.getItem('trip-hotels-v4') || '[]').length; document.getElementById('main-hotel-summary').innerText = `å®‰æ’ ${hCount} é–“`; }

Â  Â  Â  Â  window.onload = function() {
Â  Â  Â  Â  Â  Â  const moodDateEl = document.getElementById('mood-input-date'); if(moodDateEl) moodDateEl.value = new Date().toISOString().split('T')[0];
Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  const ls = document.getElementById('loading-screen');
Â  Â  Â  Â  Â  Â  Â  Â  if(ls) { ls.style.opacity = '0'; setTimeout(() => ls.style.visibility = 'hidden', 1000); }
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('main-app-container').style.opacity = '1';
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('main-app-container').style.visibility = 'visible';
Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â  // ä¾åºåŠ è¼‰
Â  Â  Â  Â  Â  Â  Â  Â  window.initDayTabs(); window.loadMExpenses(); window.loadShopping(); window.loadPrep(); window.loadRefCards(); loadMoodEntries(); loadRestEntries(); window.loadHotels(); updateSummaryDisplay();
Â  Â  Â  Â  Â  Â  }, 1200);

Â  Â  Â  Â  Â  Â  ['main-trip-title', 'main-trip-date', 'flight-out-no', 'flight-out-time', 'flight-out-price', 'flight-in-no', 'flight-in-time', 'flight-in-price'].forEach(id => {
Â  Â  Â  Â  Â  Â  Â  Â  const s = localStorage.getItem(id); if (s) { const el = document.getElementById(id); if(el) el.innerText = s; }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  const savedItinerary = localStorage.getItem('trip-itinerary-v17');
Â  Â  Â  Â  Â  Â  if (savedItinerary) itineraryData = JSON.parse(savedItinerary);
Â  Â  Â  Â  };

Â  Â  Â  Â  document.getElementById('modal-container').addEventListener('click', function(e) { if (e.target === this && !e.target.closest('.type-dropdown-list')) window.closeModal(); });
Â  Â  </script>
</body>
</html>